language: go
services:
- docker
go:
- 1.13.x
go_import_path: github.com/sourcegraph/src-cli
install:
- go get -d -t ./...
- go test -i ./...
script:
- cd $TRAVIS_BUILD_DIR
- go test -race -v ./...
env:
  global:
  - secure: eFuG5PSCXNz0i4Knic0wVmTko+O/epoLWpDtDs7jGHo3UD0JIukDTeIoHRPF56LEF3ZmfJWarc0XWZRSUmtn2EYydvCrTlroXLe6lfiFL/ctH0CWpArCp5xHQKVqKk+h6F53hAva3o181PfnFtk58H/xgj2jo8sANbqXricnL5aT34RVje85483poL2RLmd2WiYVqDqeGdkg7DaorpJra1mFvOCmInrbMpexpomJKmpCbxzrdvUmvRE9bDWLHctgvWL6bVTsQNzUN0zh6AIfT0FuFmiwjVlD5d4Bo10jUucg1qs4gglHneplPMoQb3dW7reeE1hIjuZSjXmDZKwYaonpuy8lsEJTEZpo18obYfRP9fjJZJb71rQ/sjbAd2EEV84r13k4JcprUp4uFd/LgUpHNwyRxnm2bKneHSpf9eb0D+A6Kzxkix/vSJeH8G/pHc07mYtf1rqMG57eVeeVinAFbGsvmggQfFGXupW3c48VYS6TTUmcUv0B7jiDHEdFG1zRXElX48S6HJnhI4531jxbEsvgBt63sR5wH5dZv++VodzznwjaJ4LJv+bxZEtswhNA/nzxGCk9vNDkhPxpS531mNAyfV2ewJ81QW94BuWh0dTfo6gVypCS/2xI8L2I2sqs5vk2iCr51WJDL79yLXRP6QhXLcr8jgDpBQMNbpE=
  - secure: "heQ4j+S6tViT3AKuYuOM9FegiNd2xmh/KHLxbjmrW0pPmImjjLUKzC+8JpWer2gOpsMhxImvpC2suiB2q1zXk0w1/wnyKcdgp1tHLmNi6ojWZ4Zz3V7kTFHOtJd/x5lW9xVSniEXb+JuTH4T7rwfOX3cOW3sUXi2zongaPG81elp/0FA4wN/GF2Y8eVQlow0gLvTOJHH2HdaNCoLl9hZ5XavFdsTfBA+8m8vfCYS/4XkLHxf7mbaUm+RhsXOv/ko1fI2daL7EEJLoHcmDCcmr+ZwgUrmQmEDjUXltelkYYLDuFwDLO/D3lWYA6PuEmAT4ygY3z6NSGDn1yp3Z+StSI6cUGGTusHqTCIHxQZomnjoOf1UOg/Bu6z0+O38sdtSsxWl9R0HPgziYFbDqglvYCpeaY0ctED4oKZlisuULEczziLUVhPSUMu1Wshg4UznrRdyKXi1ZTOdhpECQ0FnyqVJ8L33yh9URyxLN54sUfoQQeaMm+0a5m3JcscwIch/x4PF/PqIziDn39JMH36ztjVGqHAWmzwSZYuxGKp19lBGBrd4QHr1ZUGAp/oCiWRBkCvMCFnoP5JoIra2JVAI2JdMAKHtPWYfAegFUyno8ui7WYcnW+kx/vRgrmatnVo46/JpJ3FyxPEPIqFaufwkYv4LIgcAnGkfBAlJRIK1UxY="
after_success:
- test -n "$TRAVIS_TAG" && echo "${DOCKER_PASSWORD}" | docker login -u=sourcegraphci --password-stdin
deploy:
- provider: script
  script:
  - curl -sL https://git.io/goreleaser | bash
  overwrite: true
  skip_cleanup: true
  on:
    tags: true
    condition: "$TRAVIS_OS_NAME = linux"
